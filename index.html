<!doctype html>
<html lang = "en-nz">
    <head> 
        <script type="application/ld+json">
            {
              "@context": "https://schema.org",
              "@type": "WebSite",
              "name": "LeafMatch",
              "url": "https://leafmatch.org/"
            }
        </script>
        <script>
          if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js')
              .then(reg => console.log('Service Worker registered!', reg))
              .catch(err => console.error('Service Worker registration failed:', err));
          }
        </script>
        <script>
            if (!navigator.userAgent.match(/Android|iPhone|iPad|iPod|Tablet|BlackBerry|Windows Phone/i)) {
                window.location.href = "desktop";
            }
        </script>
        <meta charset="UTF-8"> 
        <meta name="description" content="LeafMatch. Use the LeafMatch app to scan and identify plants. Download on mobile to use offline.">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta content="LeafMatch" name="application-name"/>
        <link rel="manifest" href="/manifest.json">
        <meta name="theme-color" content="#000000">
        <link rel="apple-touch-icon" href="/images/ui/loading.png">
        <meta name="keywords" content="plants, leaf match, leaf identification, environment, AI">
        <meta name="author" content="LeafMatch">
        <meta property="og:site_name" content="LeafMatch">
        <title>LeafMatch</title>
        <link rel="preload" href="images/ui/loadingwithbg.png" as="image">
        <link rel="stylesheet" href="css/styles.css">
        <link rel="icon" type="image/x-icon" href="images/favicon.ico">
        <link rel="icon" type="image/x-icon" href="images/favicon.png">
        <link rel="apple-touch-icon" sizes="180x180" href="images/favicon.png">
    </head>
    <body onload="endLoadingScreen()">
        <div id="loadingscreen" class="loadingscreen">
            <img src="images/ui/loading.png" id="loader" class="loader" alt="loading.png">
        </div>
        <img src="images/ui/loadingwithbg.png" id="smallloader" class="smallloader" alt="Loading...">

        
        <img draggable="false" onclick="acceptedPhoto()" src="images/ui/tick.png" alt="accept" class="tick" id="tick">
        <img draggable="false" onclick="retakePhoto()" src="images/ui/cross.png" alt="retake" class="cross" id="cross">
        
        <div id="prompt" class="prompt">
            <h1>We need your camera for this!</h1>
            <p>In order for LeafMatch to properly work, we need access to your camera. 
            <br>If choose not to allow camera access, you can use the upload button to upload an image for scanning.</p>
            <button onclick="promptAccepted()">Give access</button>
            <button onclick="promptClose()">No thanks</button>
        </div>
        
        <div id="denied" class="prompt">
            <h1>Camera Blocked :(</h1>
            <p>You have camera access disabled for this site. To take pictures for scanning, please allow access or use the upload files button.
            <br>You may need to reload the page for permission changes to take effect</p>
            <button onclick="deniedClose()">Okay</button>
        </div>

        <div id="failed" class="prompt">
            <h1>Couldn't Identify Object</h1>
            <p>Our AI couldn't tell what the photo was of, try getting a better angle or focus on important elements</p>
            <button onclick="retakePhoto()">Okay</button>
        </div>
        
        <img id="nocamera" class="nocamera" src="images/ui/nocamera.jpg" alt="nocamera">
        <img class="nocameraback" src="images/ui/nocamera.jpg" id ="nocameraback" alt="nocamera">

        
        <div class="sidebar" id="sidebar">
            <div class="row">
                <img class="hover" onclick="closeSidebar()" src="images/favicon.ico" style="width: 45%; top: 50%" alt="logo">
                <a class="hover" style="font-size: 75px" onclick="closeSidebar()">&times;</a>
            </div>
            <input type="search" placeholder="Search" id="sidebarSearch">
            <a class="active" onclick="closeSidebar()">Scan</a>
            <a href="database">Database</a>
            <a href="download">Download</a>
            <a href="help">Help</a>
            <a href="about">About us</a>
        </div>
        <div style="border: 3px solid black;">
            <canvas id="canvas" style="display:none;"></canvas>
            <video id="video" autoplay playsinline muted></video>
        </div>

        <img draggable="false" onclick="changeFullscreen()" id="fullscreen" class="fullscreen" src="images/ui/fullscreen.png" alt="Fullscreen">
        <img draggable="false" onclick="openSidebar()" id="toggleSidebar" class="sidebarimg" src="images/ui/sidebar.png" alt="Open Sidebar">
        
        <img draggable="false" src="images/ui/switchcamera.png" onclick="changeValue()" id="button1" class="switchcameraimage" alt="Switch camera">
        <img draggable="false" src="images/ui/takepicture.png" alt="Take photo" onclick="flash();takePhoto()" class="takephotoimage" id="birb">
        <img draggable="false" src="images/ui/addfilesbutton.png" alt="Upload from gallery" onclick="uploadstart()" class="uploadimage" id="uploadbutton">
        <input type="file" id="fileInput" accept="image/*" style="display:none;" onchange="upload()">
        
        <img draggable="false" id="photo" class="photo">

        <script src="/scripts/scripts.js"></script>
        <script src="scripts/search.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script>
        <script src="/scripts/ai.js"></script>
    </body>
</html>
